const o=new URL(document.currentScript.src),r=`${o.origin}/api/send`,s=document.currentScript.getAttribute("website"),c=history.pushState;history.pushState=function(){const t=c.apply(this,arguments);return window.dispatchEvent(new Event("locationchange")),t};async function a(e){try{const t=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){console.log("Statistics sent successfully!");const{token:n}=await t.json();sessionStorage.setItem("stat-token",n)}else console.error("Failed to send statistics:",t.status)}catch(t){console.error("Error sending statistics:",t)}}function i(e="view"){if(!s){console.error("Missing website attribute!");return}const t={type:e,url:window.location.href,referrer:document.referrer,title:document.title,screen:`${window.screen.width}x${window.screen.height}`,language:window.navigator.language,website:s},n=sessionStorage.getItem("stat-token");n&&(t.token=n),console.log(t),a(t)}function d(e){e.target.tagName.toLowerCase()==="a"&&console.log("Link clicked")}function w(){i("activity")}function l(){window.addEventListener("DOMContentLoaded",()=>i()),window.addEventListener("popstate",()=>i()),window.addEventListener("locationchange",()=>i()),window.addEventListener("click",d),window.addEventListener("visibilitychange",w)}l();
